{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _s, _e;\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n  return _arr;\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nimport Hooks from \"../../pluginHooks.mjs\";\nimport { arrayMap, arrayEach } from \"../../helpers/array.mjs\";\nimport { rangeEach } from \"../../helpers/number.mjs\";\nimport { inherit, deepClone } from \"../../helpers/object.mjs\";\nimport { stopImmediatePropagation, isImmediatePropagationStopped } from \"../../helpers/dom/event.mjs\";\nimport { align } from \"../contextMenu/utils.mjs\";\nexport var PLUGIN_KEY = 'undoRedo';\n/**\n * @description\n * Handsontable UndoRedo plugin allows to undo and redo certain actions done in the table.\n *\n * __Note__, that not all actions are currently undo-able. The UndoRedo plugin is enabled by default.\n * @example\n * ```js\n * undo: true\n * ```\n * @class UndoRedo\n * @plugin UndoRedo\n * @param {Core} instance The Handsontable instance.\n */\n\nfunction UndoRedo(instance) {\n  var plugin = this;\n  this.instance = instance;\n  this.doneActions = [];\n  this.undoneActions = [];\n  this.ignoreNewActions = false;\n  this.enabled = false;\n  instance.addHook('afterChange', function (changes, source) {\n    var _this = this;\n    var changesLen = changes && changes.length;\n    if (!changesLen) {\n      return;\n    }\n    var hasDifferences = changes.find(function (change) {\n      var _change = _slicedToArray(change, 4),\n        oldValue = _change[2],\n        newValue = _change[3];\n      return oldValue !== newValue;\n    });\n    if (!hasDifferences) {\n      return;\n    }\n    var wrappedAction = function wrappedAction() {\n      var clonedChanges = changes.reduce(function (arr, change) {\n        arr.push(_toConsumableArray(change));\n        return arr;\n      }, []);\n      arrayEach(clonedChanges, function (change) {\n        change[1] = instance.propToCol(change[1]);\n      });\n      var selected = changesLen > 1 ? _this.getSelected() : [[clonedChanges[0][0], clonedChanges[0][1]]];\n      return new UndoRedo.ChangeAction(clonedChanges, selected);\n    };\n    plugin.done(wrappedAction, source);\n  });\n  instance.addHook('afterCreateRow', function (index, amount, source) {\n    plugin.done(function () {\n      return new UndoRedo.CreateRowAction(index, amount);\n    }, source);\n  });\n  instance.addHook('beforeRemoveRow', function (index, amount, logicRows, source) {\n    var wrappedAction = function wrappedAction() {\n      var originalData = plugin.instance.getSourceDataArray();\n      var rowIndex = (originalData.length + index) % originalData.length;\n      var physicalRowIndex = instance.toPhysicalRow(rowIndex);\n      var removedData = deepClone(originalData.slice(physicalRowIndex, physicalRowIndex + amount));\n      return new UndoRedo.RemoveRowAction(rowIndex, removedData, instance.getSettings().fixedRowsBottom, instance.getSettings().fixedRowsTop);\n    };\n    plugin.done(wrappedAction, source);\n  });\n  instance.addHook('afterCreateCol', function (index, amount, source) {\n    plugin.done(function () {\n      return new UndoRedo.CreateColumnAction(index, amount);\n    }, source);\n  });\n  instance.addHook('beforeRemoveCol', function (index, amount, logicColumns, source) {\n    var wrappedAction = function wrappedAction() {\n      var originalData = plugin.instance.getSourceDataArray();\n      var columnIndex = (plugin.instance.countCols() + index) % plugin.instance.countCols();\n      var removedData = [];\n      var headers = [];\n      var indexes = [];\n      rangeEach(originalData.length - 1, function (i) {\n        var column = [];\n        var origRow = originalData[i];\n        rangeEach(columnIndex, columnIndex + (amount - 1), function (j) {\n          column.push(origRow[instance.toPhysicalColumn(j)]);\n        });\n        removedData.push(column);\n      });\n      rangeEach(amount - 1, function (i) {\n        indexes.push(instance.toPhysicalColumn(columnIndex + i));\n      });\n      if (Array.isArray(instance.getSettings().colHeaders)) {\n        rangeEach(amount - 1, function (i) {\n          headers.push(instance.getSettings().colHeaders[instance.toPhysicalColumn(columnIndex + i)] || null);\n        });\n      }\n      var columnsMap = instance.columnIndexMapper.getIndexesSequence();\n      var rowsMap = instance.rowIndexMapper.getIndexesSequence();\n      return new UndoRedo.RemoveColumnAction(columnIndex, indexes, removedData, headers, columnsMap, rowsMap, instance.getSettings().fixedColumnsLeft);\n    };\n    plugin.done(wrappedAction, source);\n  });\n  instance.addHook('beforeCellAlignment', function (stateBefore, range, type, alignment) {\n    plugin.done(function () {\n      return new UndoRedo.CellAlignmentAction(stateBefore, range, type, alignment);\n    });\n  });\n  instance.addHook('beforeFilter', function (conditionsStack) {\n    plugin.done(function () {\n      return new UndoRedo.FiltersAction(conditionsStack);\n    });\n  });\n  instance.addHook('beforeRowMove', function (rows, finalIndex) {\n    if (rows === false) {\n      return;\n    }\n    plugin.done(function () {\n      return new UndoRedo.RowMoveAction(rows, finalIndex);\n    });\n  });\n  instance.addHook('beforeMergeCells', function (cellRange, auto) {\n    if (auto) {\n      return;\n    }\n    plugin.done(function () {\n      return new UndoRedo.MergeCellsAction(instance, cellRange);\n    });\n  });\n  instance.addHook('afterUnmergeCells', function (cellRange, auto) {\n    if (auto) {\n      return;\n    }\n    plugin.done(function () {\n      return new UndoRedo.UnmergeCellsAction(instance, cellRange);\n    });\n  }); // TODO: Why this callback is needed? One test doesn't pass after calling method right after plugin creation (outside the callback).\n\n  instance.addHook('afterInit', function () {\n    plugin.init();\n  });\n}\n/**\n * Stash information about performed actions.\n *\n * @function done\n * @memberof UndoRedo#\n * @fires Hooks#beforeUndoStackChange\n * @fires Hooks#afterUndoStackChange\n * @fires Hooks#beforeRedoStackChange\n * @fires Hooks#afterRedoStackChange\n * @param {Function} wrappedAction The action descriptor wrapped in a closure.\n * @param {string} [source] Source of the action. It is defined just for more general actions (not related to plugins).\n */\n\nUndoRedo.prototype.done = function (wrappedAction, source) {\n  if (this.ignoreNewActions) {\n    return;\n  }\n  var isBlockedByDefault = source === 'UndoRedo.undo' || source === 'UndoRedo.redo' || source === 'auto';\n  if (isBlockedByDefault) {\n    return;\n  }\n  var doneActionsCopy = this.doneActions.slice();\n  var continueAction = this.instance.runHooks('beforeUndoStackChange', doneActionsCopy, source);\n  if (continueAction === false) {\n    return;\n  }\n  var newAction = wrappedAction();\n  var undoneActionsCopy = this.undoneActions.slice();\n  this.doneActions.push(newAction);\n  this.instance.runHooks('afterUndoStackChange', doneActionsCopy, this.doneActions.slice());\n  this.instance.runHooks('beforeRedoStackChange', undoneActionsCopy);\n  this.undoneActions.length = 0;\n  this.instance.runHooks('afterRedoStackChange', undoneActionsCopy, this.undoneActions.slice());\n};\n/**\n * Undo the last action performed to the table.\n *\n * @function undo\n * @memberof UndoRedo#\n * @fires Hooks#beforeUndoStackChange\n * @fires Hooks#afterUndoStackChange\n * @fires Hooks#beforeRedoStackChange\n * @fires Hooks#afterRedoStackChange\n * @fires Hooks#beforeUndo\n * @fires Hooks#afterUndo\n */\n\nUndoRedo.prototype.undo = function () {\n  if (this.isUndoAvailable()) {\n    var doneActionsCopy = this.doneActions.slice();\n    this.instance.runHooks('beforeUndoStackChange', doneActionsCopy);\n    var action = this.doneActions.pop();\n    this.instance.runHooks('afterUndoStackChange', doneActionsCopy, this.doneActions.slice());\n    var actionClone = deepClone(action);\n    var continueAction = this.instance.runHooks('beforeUndo', actionClone);\n    if (continueAction === false) {\n      return;\n    }\n    this.ignoreNewActions = true;\n    var that = this;\n    var undoneActionsCopy = this.undoneActions.slice();\n    this.instance.runHooks('beforeRedoStackChange', undoneActionsCopy);\n    action.undo(this.instance, function () {\n      that.ignoreNewActions = false;\n      that.undoneActions.push(action);\n    });\n    this.instance.runHooks('afterRedoStackChange', undoneActionsCopy, this.undoneActions.slice());\n    this.instance.runHooks('afterUndo', actionClone);\n  }\n};\n/**\n * Redo the previous action performed to the table (used to reverse an undo).\n *\n * @function redo\n * @memberof UndoRedo#\n * @fires Hooks#beforeUndoStackChange\n * @fires Hooks#afterUndoStackChange\n * @fires Hooks#beforeRedoStackChange\n * @fires Hooks#afterRedoStackChange\n * @fires Hooks#beforeRedo\n * @fires Hooks#afterRedo\n */\n\nUndoRedo.prototype.redo = function () {\n  if (this.isRedoAvailable()) {\n    var undoneActionsCopy = this.undoneActions.slice();\n    this.instance.runHooks('beforeRedoStackChange', undoneActionsCopy);\n    var action = this.undoneActions.pop();\n    this.instance.runHooks('afterRedoStackChange', undoneActionsCopy, this.undoneActions.slice());\n    var actionClone = deepClone(action);\n    var continueAction = this.instance.runHooks('beforeRedo', actionClone);\n    if (continueAction === false) {\n      return;\n    }\n    this.ignoreNewActions = true;\n    var that = this;\n    var doneActionsCopy = this.doneActions.slice();\n    this.instance.runHooks('beforeUndoStackChange', doneActionsCopy);\n    action.redo(this.instance, function () {\n      that.ignoreNewActions = false;\n      that.doneActions.push(action);\n    });\n    this.instance.runHooks('afterUndoStackChange', doneActionsCopy, this.doneActions.slice());\n    this.instance.runHooks('afterRedo', actionClone);\n  }\n};\n/**\n * Checks if undo action is available.\n *\n * @function isUndoAvailable\n * @memberof UndoRedo#\n * @returns {boolean} Return `true` if undo can be performed, `false` otherwise.\n */\n\nUndoRedo.prototype.isUndoAvailable = function () {\n  return this.doneActions.length > 0;\n};\n/**\n * Checks if redo action is available.\n *\n * @function isRedoAvailable\n * @memberof UndoRedo#\n * @returns {boolean} Return `true` if redo can be performed, `false` otherwise.\n */\n\nUndoRedo.prototype.isRedoAvailable = function () {\n  return this.undoneActions.length > 0;\n};\n/**\n * Clears undo history.\n *\n * @function clear\n * @memberof UndoRedo#\n */\n\nUndoRedo.prototype.clear = function () {\n  this.doneActions.length = 0;\n  this.undoneActions.length = 0;\n};\n/**\n * Checks if the plugin is enabled.\n *\n * @function isEnabled\n * @memberof UndoRedo#\n * @returns {boolean}\n */\n\nUndoRedo.prototype.isEnabled = function () {\n  return this.enabled;\n};\n/**\n * Enables the plugin.\n *\n * @function enable\n * @memberof UndoRedo#\n */\n\nUndoRedo.prototype.enable = function () {\n  if (this.isEnabled()) {\n    return;\n  }\n  var hot = this.instance;\n  this.enabled = true;\n  exposeUndoRedoMethods(hot);\n  hot.addHook('beforeKeyDown', onBeforeKeyDown);\n  hot.addHook('afterChange', onAfterChange);\n};\n/**\n * Disables the plugin.\n *\n * @function disable\n * @memberof UndoRedo#\n */\n\nUndoRedo.prototype.disable = function () {\n  if (!this.isEnabled()) {\n    return;\n  }\n  var hot = this.instance;\n  this.enabled = false;\n  removeExposedUndoRedoMethods(hot);\n  hot.removeHook('beforeKeyDown', onBeforeKeyDown);\n  hot.removeHook('afterChange', onAfterChange);\n};\n/**\n * Destroys the instance.\n *\n * @function destroy\n * @memberof UndoRedo#\n */\n\nUndoRedo.prototype.destroy = function () {\n  this.clear();\n  this.instance = null;\n  this.doneActions = null;\n  this.undoneActions = null;\n};\nUndoRedo.Action = function () {};\nUndoRedo.Action.prototype.undo = function () {};\nUndoRedo.Action.prototype.redo = function () {};\n/**\n * Change action.\n *\n * @private\n * @param {Array} changes 2D array containing information about each of the edited cells.\n * @param {number[]} selected The cell selection.\n */\n\nUndoRedo.ChangeAction = function (changes, selected) {\n  this.changes = changes;\n  this.selected = selected;\n  this.actionType = 'change';\n};\ninherit(UndoRedo.ChangeAction, UndoRedo.Action);\nUndoRedo.ChangeAction.prototype.undo = function (instance, undoneCallback) {\n  var data = deepClone(this.changes);\n  var emptyRowsAtTheEnd = instance.countEmptyRows(true);\n  var emptyColsAtTheEnd = instance.countEmptyCols(true);\n  for (var i = 0, len = data.length; i < len; i++) {\n    data[i].splice(3, 1);\n  }\n  instance.addHookOnce('afterChange', undoneCallback);\n  instance.setDataAtCell(data, null, null, 'UndoRedo.undo');\n  for (var _i2 = 0, _len = data.length; _i2 < _len; _i2++) {\n    var _data$_i = _slicedToArray(data[_i2], 2),\n      row = _data$_i[0],\n      column = _data$_i[1];\n    if (instance.getSettings().minSpareRows && row + 1 + instance.getSettings().minSpareRows === instance.countRows() && emptyRowsAtTheEnd === instance.getSettings().minSpareRows) {\n      instance.alter('remove_row', parseInt(row + 1, 10), instance.getSettings().minSpareRows);\n      instance.undoRedo.doneActions.pop();\n    }\n    if (instance.getSettings().minSpareCols && column + 1 + instance.getSettings().minSpareCols === instance.countCols() && emptyColsAtTheEnd === instance.getSettings().minSpareCols) {\n      instance.alter('remove_col', parseInt(column + 1, 10), instance.getSettings().minSpareCols);\n      instance.undoRedo.doneActions.pop();\n    }\n  }\n  instance.selectCells(this.selected, false, false);\n};\nUndoRedo.ChangeAction.prototype.redo = function (instance, onFinishCallback) {\n  var data = deepClone(this.changes);\n  for (var i = 0, len = data.length; i < len; i++) {\n    data[i].splice(2, 1);\n  }\n  instance.addHookOnce('afterChange', onFinishCallback);\n  instance.setDataAtCell(data, null, null, 'UndoRedo.redo');\n  if (this.selected) {\n    instance.selectCells(this.selected, false, false);\n  }\n};\n/**\n * Create row action.\n *\n * @private\n * @param {number} index The visual row index.\n * @param {number} amount The number of created rows.\n */\n\nUndoRedo.CreateRowAction = function (index, amount) {\n  this.index = index;\n  this.amount = amount;\n  this.actionType = 'insert_row';\n};\ninherit(UndoRedo.CreateRowAction, UndoRedo.Action);\nUndoRedo.CreateRowAction.prototype.undo = function (instance, undoneCallback) {\n  var rowCount = instance.countRows();\n  var minSpareRows = instance.getSettings().minSpareRows;\n  if (this.index >= rowCount && this.index - minSpareRows < rowCount) {\n    this.index -= minSpareRows; // work around the situation where the needed row was removed due to an 'undo' of a made change\n  }\n  instance.addHookOnce('afterRemoveRow', undoneCallback);\n  instance.alter('remove_row', this.index, this.amount, 'UndoRedo.undo');\n};\nUndoRedo.CreateRowAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterCreateRow', redoneCallback);\n  instance.alter('insert_row', this.index, this.amount, 'UndoRedo.redo');\n};\n/**\n * Remove row action.\n *\n * @private\n * @param {number} index The visual row index.\n * @param {Array} data The removed data.\n * @param {number} fixedRowsBottom Number of fixed rows on the bottom. Remove row action change it sometimes.\n * @param {number} fixedRowsTop Number of fixed rows on the top. Remove row action change it sometimes.\n */\n\nUndoRedo.RemoveRowAction = function (index, data, fixedRowsBottom, fixedRowsTop) {\n  this.index = index;\n  this.data = data;\n  this.actionType = 'remove_row';\n  this.fixedRowsBottom = fixedRowsBottom;\n  this.fixedRowsTop = fixedRowsTop;\n};\ninherit(UndoRedo.RemoveRowAction, UndoRedo.Action);\nUndoRedo.RemoveRowAction.prototype.undo = function (instance, undoneCallback) {\n  var settings = instance.getSettings(); // Changing by the reference as `updateSettings` doesn't work the best.\n\n  settings.fixedRowsBottom = this.fixedRowsBottom;\n  settings.fixedRowsTop = this.fixedRowsTop;\n  instance.alter('insert_row', this.index, this.data.length, 'UndoRedo.undo');\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.populateFromArray(this.index, 0, this.data, void 0, void 0, 'UndoRedo.undo');\n};\nUndoRedo.RemoveRowAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterRemoveRow', redoneCallback);\n  instance.alter('remove_row', this.index, this.data.length, 'UndoRedo.redo');\n};\n/**\n * Create column action.\n *\n * @private\n * @param {number} index The visual column index.\n * @param {number} amount The number of created columns.\n */\n\nUndoRedo.CreateColumnAction = function (index, amount) {\n  this.index = index;\n  this.amount = amount;\n  this.actionType = 'insert_col';\n};\ninherit(UndoRedo.CreateColumnAction, UndoRedo.Action);\nUndoRedo.CreateColumnAction.prototype.undo = function (instance, undoneCallback) {\n  instance.addHookOnce('afterRemoveCol', undoneCallback);\n  instance.alter('remove_col', this.index, this.amount, 'UndoRedo.undo');\n};\nUndoRedo.CreateColumnAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterCreateCol', redoneCallback);\n  instance.alter('insert_col', this.index, this.amount, 'UndoRedo.redo');\n};\n/**\n * Remove column action.\n *\n * @private\n * @param {number} index The visual column index.\n * @param {number[]} indexes The visual column indexes.\n * @param {Array} data The removed data.\n * @param {Array} headers The header values.\n * @param {number[]} columnPositions The column position.\n * @param {number[]} rowPositions The row position.\n * @param {number} fixedColumnsLeft Number of fixed columns on the left. Remove column action change it sometimes.\n */\n\nUndoRedo.RemoveColumnAction = function (index, indexes, data, headers, columnPositions, rowPositions, fixedColumnsLeft) {\n  this.index = index;\n  this.indexes = indexes;\n  this.data = data;\n  this.amount = this.data[0].length;\n  this.headers = headers;\n  this.columnPositions = columnPositions.slice(0);\n  this.rowPositions = rowPositions.slice(0);\n  this.actionType = 'remove_col';\n  this.fixedColumnsLeft = fixedColumnsLeft;\n};\ninherit(UndoRedo.RemoveColumnAction, UndoRedo.Action);\nUndoRedo.RemoveColumnAction.prototype.undo = function (instance, undoneCallback) {\n  var _this2 = this;\n  var settings = instance.getSettings(); // Changing by the reference as `updateSettings` doesn't work the best.\n\n  settings.fixedColumnsLeft = this.fixedColumnsLeft;\n  var ascendingIndexes = this.indexes.slice(0).sort();\n  var sortByIndexes = function sortByIndexes(elem, j, arr) {\n    return arr[_this2.indexes.indexOf(ascendingIndexes[j])];\n  };\n  var removedDataLength = this.data.length;\n  var sortedData = [];\n  for (var rowIndex = 0; rowIndex < removedDataLength; rowIndex++) {\n    sortedData.push(arrayMap(this.data[rowIndex], sortByIndexes));\n  }\n  var sortedHeaders = arrayMap(this.headers, sortByIndexes);\n  var changes = [];\n  instance.alter('insert_col', this.indexes[0], this.indexes.length, 'UndoRedo.undo');\n  arrayEach(instance.getSourceDataArray(), function (rowData, rowIndex) {\n    arrayEach(ascendingIndexes, function (changedIndex, contiquesIndex) {\n      rowData[changedIndex] = sortedData[rowIndex][contiquesIndex];\n      changes.push([rowIndex, changedIndex, rowData[changedIndex]]);\n    });\n  });\n  instance.setSourceDataAtCell(changes, void 0, void 0, 'UndoRedo.undo');\n  instance.columnIndexMapper.insertIndexes(ascendingIndexes[0], ascendingIndexes.length);\n  if (typeof this.headers !== 'undefined') {\n    arrayEach(sortedHeaders, function (headerData, columnIndex) {\n      instance.getSettings().colHeaders[ascendingIndexes[columnIndex]] = headerData;\n    });\n  }\n  instance.batchExecution(function () {\n    // Restore row sequence in a case when all columns are removed. the original\n    // row sequence is lost in that case.\n    instance.rowIndexMapper.setIndexesSequence(_this2.rowPositions);\n    instance.columnIndexMapper.setIndexesSequence(_this2.columnPositions);\n  }, true);\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.render();\n};\nUndoRedo.RemoveColumnAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterRemoveCol', redoneCallback);\n  instance.alter('remove_col', this.index, this.amount, 'UndoRedo.redo');\n};\n/**\n * Cell alignment action.\n *\n * @private\n * @param {Array} stateBefore The previous state.\n * @param {object} range The cell range.\n * @param {string} type The type of the alignment (\"top\", \"left\", \"bottom\" or \"right\").\n * @param {string} alignment The alignment CSS class.\n */\n\nUndoRedo.CellAlignmentAction = function (stateBefore, range, type, alignment) {\n  this.stateBefore = stateBefore;\n  this.range = range;\n  this.type = type;\n  this.alignment = alignment;\n};\nUndoRedo.CellAlignmentAction.prototype.undo = function (instance, undoneCallback) {\n  var _this3 = this;\n  arrayEach(this.range, function (range) {\n    range.forAll(function (row, col) {\n      // Alignment classes should only collected within cell ranges. We skip header coordinates.\n      if (row >= 0 && col >= 0) {\n        instance.setCellMeta(row, col, 'className', _this3.stateBefore[row][col] || ' htLeft');\n      }\n    });\n  });\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.render();\n};\nUndoRedo.CellAlignmentAction.prototype.redo = function (instance, undoneCallback) {\n  align(this.range, this.type, this.alignment, function (row, col) {\n    return instance.getCellMeta(row, col);\n  }, function (row, col, key, value) {\n    return instance.setCellMeta(row, col, key, value);\n  });\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.render();\n};\n/**\n * Filters action.\n *\n * @private\n * @param {Array} conditionsStack An array of the filter condition.\n */\n\nUndoRedo.FiltersAction = function (conditionsStack) {\n  this.conditionsStack = conditionsStack;\n  this.actionType = 'filter';\n};\ninherit(UndoRedo.FiltersAction, UndoRedo.Action);\nUndoRedo.FiltersAction.prototype.undo = function (instance, undoneCallback) {\n  var filters = instance.getPlugin('filters');\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  filters.conditionCollection.importAllConditions(this.conditionsStack.slice(0, this.conditionsStack.length - 1));\n  filters.filter();\n};\nUndoRedo.FiltersAction.prototype.redo = function (instance, redoneCallback) {\n  var filters = instance.getPlugin('filters');\n  instance.addHookOnce('afterViewRender', redoneCallback);\n  filters.conditionCollection.importAllConditions(this.conditionsStack);\n  filters.filter();\n};\n/**\n * Merge Cells action.\n *\n * @util\n */\n\nvar MergeCellsAction = /*#__PURE__*/function (_UndoRedo$Action) {\n  _inherits(MergeCellsAction, _UndoRedo$Action);\n  var _super = _createSuper(MergeCellsAction);\n  function MergeCellsAction(instance, cellRange) {\n    var _this4;\n    _classCallCheck(this, MergeCellsAction);\n    _this4 = _super.call(this);\n    _this4.cellRange = cellRange;\n    var topLeftCorner = _this4.cellRange.getTopLeftCorner();\n    var bottomRightCorner = _this4.cellRange.getBottomRightCorner();\n    _this4.rangeData = instance.getData(topLeftCorner.row, topLeftCorner.col, bottomRightCorner.row, bottomRightCorner.col);\n    return _this4;\n  }\n  _createClass(MergeCellsAction, [{\n    key: \"undo\",\n    value: function undo(instance, undoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', undoneCallback);\n      mergeCellsPlugin.unmergeRange(this.cellRange, true);\n      var topLeftCorner = this.cellRange.getTopLeftCorner();\n      instance.populateFromArray(topLeftCorner.row, topLeftCorner.col, this.rangeData, void 0, void 0, 'MergeCells');\n    }\n  }, {\n    key: \"redo\",\n    value: function redo(instance, redoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', redoneCallback);\n      mergeCellsPlugin.mergeRange(this.cellRange);\n    }\n  }]);\n  return MergeCellsAction;\n}(UndoRedo.Action);\nUndoRedo.MergeCellsAction = MergeCellsAction;\n/**\n * Unmerge Cells action.\n *\n * @util\n */\n\nvar UnmergeCellsAction = /*#__PURE__*/function (_UndoRedo$Action2) {\n  _inherits(UnmergeCellsAction, _UndoRedo$Action2);\n  var _super2 = _createSuper(UnmergeCellsAction);\n  function UnmergeCellsAction(instance, cellRange) {\n    var _this5;\n    _classCallCheck(this, UnmergeCellsAction);\n    _this5 = _super2.call(this);\n    _this5.cellRange = cellRange;\n    return _this5;\n  }\n  _createClass(UnmergeCellsAction, [{\n    key: \"undo\",\n    value: function undo(instance, undoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', undoneCallback);\n      mergeCellsPlugin.mergeRange(this.cellRange, true);\n    }\n  }, {\n    key: \"redo\",\n    value: function redo(instance, redoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', redoneCallback);\n      mergeCellsPlugin.unmergeRange(this.cellRange, true);\n      instance.render();\n    }\n  }]);\n  return UnmergeCellsAction;\n}(UndoRedo.Action);\nUndoRedo.UnmergeCellsAction = UnmergeCellsAction;\n/**\n * ManualRowMove action.\n *\n * @TODO removeRow undo should works on logical index\n * @private\n * @param {number[]} rows An array with moved rows.\n * @param {number} finalIndex The destination index.\n */\n\nUndoRedo.RowMoveAction = function (rows, finalIndex) {\n  this.rows = rows.slice();\n  this.finalIndex = finalIndex;\n  this.actionType = 'row_move';\n};\ninherit(UndoRedo.RowMoveAction, UndoRedo.Action);\nUndoRedo.RowMoveAction.prototype.undo = function (instance, undoneCallback) {\n  var _this6 = this;\n  var manualRowMove = instance.getPlugin('manualRowMove');\n  var copyOfRows = [].concat(this.rows);\n  var rowsMovedUp = copyOfRows.filter(function (a) {\n    return a > _this6.finalIndex;\n  });\n  var rowsMovedDown = copyOfRows.filter(function (a) {\n    return a <= _this6.finalIndex;\n  });\n  var allMovedRows = rowsMovedUp.sort(function (a, b) {\n    return b - a;\n  }).concat(rowsMovedDown.sort(function (a, b) {\n    return a - b;\n  }));\n  instance.addHookOnce('afterViewRender', undoneCallback); // Moving rows from those with higher indexes to those with lower indexes when action was performed from bottom to top\n  // Moving rows from those with lower indexes to those with higher indexes when action was performed from top to bottom\n\n  for (var i = 0; i < allMovedRows.length; i += 1) {\n    var newPhysicalRow = instance.toVisualRow(allMovedRows[i]);\n    manualRowMove.moveRow(newPhysicalRow, allMovedRows[i]);\n  }\n  instance.render();\n  instance.deselectCell();\n  instance.selectRows(this.rows[0], this.rows[0] + this.rows.length - 1);\n};\nUndoRedo.RowMoveAction.prototype.redo = function (instance, redoneCallback) {\n  var manualRowMove = instance.getPlugin('manualRowMove');\n  instance.addHookOnce('afterViewRender', redoneCallback);\n  manualRowMove.moveRows(this.rows.slice(), this.finalIndex);\n  instance.render();\n  instance.deselectCell();\n  instance.selectRows(this.finalIndex, this.finalIndex + this.rows.length - 1);\n};\n/**\n * Enabling and disabling plugin and attaching its to an instance.\n *\n * @private\n */\n\nUndoRedo.prototype.init = function () {\n  var settings = this.instance.getSettings().undo;\n  var pluginEnabled = typeof settings === 'undefined' || settings;\n  if (!this.instance.undoRedo) {\n    this.instance.undoRedo = this;\n  }\n  if (pluginEnabled) {\n    this.instance.undoRedo.enable();\n  } else {\n    this.instance.undoRedo.disable();\n  }\n};\n/**\n * @param {Event} event The keyboard event object.\n */\n\nfunction onBeforeKeyDown(event) {\n  if (isImmediatePropagationStopped(event)) {\n    return;\n  }\n  var instance = this;\n  var editor = instance.getActiveEditor();\n  if (editor && editor.isOpened()) {\n    return;\n  }\n  var altKey = event.altKey,\n    ctrlKey = event.ctrlKey,\n    keyCode = event.keyCode,\n    metaKey = event.metaKey,\n    shiftKey = event.shiftKey;\n  var isCtrlDown = (ctrlKey || metaKey) && !altKey;\n  if (!isCtrlDown) {\n    return;\n  }\n  var isRedoHotkey = keyCode === 89 || shiftKey && keyCode === 90;\n  if (isRedoHotkey) {\n    // CTRL + Y or CTRL + SHIFT + Z\n    instance.undoRedo.redo();\n    stopImmediatePropagation(event);\n  } else if (keyCode === 90) {\n    // CTRL + Z\n    instance.undoRedo.undo();\n    stopImmediatePropagation(event);\n  }\n}\n/**\n * @param {Array} changes 2D array containing information about each of the edited cells.\n * @param {string} source String that identifies source of hook call.\n * @returns {boolean}\n */\n\nfunction onAfterChange(changes, source) {\n  var instance = this;\n  if (source === 'loadData') {\n    return instance.undoRedo.clear();\n  }\n}\n/**\n * @param {Core} instance The Handsontable instance.\n */\n\nfunction exposeUndoRedoMethods(instance) {\n  /**\n   * {@link UndoRedo#undo}.\n   *\n   * @alias undo\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n  instance.undo = function () {\n    return instance.undoRedo.undo();\n  };\n  /**\n   * {@link UndoRedo#redo}.\n   *\n   * @alias redo\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n  instance.redo = function () {\n    return instance.undoRedo.redo();\n  };\n  /**\n   * {@link UndoRedo#isUndoAvailable}.\n   *\n   * @alias isUndoAvailable\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n  instance.isUndoAvailable = function () {\n    return instance.undoRedo.isUndoAvailable();\n  };\n  /**\n   * {@link UndoRedo#isRedoAvailable}.\n   *\n   * @alias isRedoAvailable\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n  instance.isRedoAvailable = function () {\n    return instance.undoRedo.isRedoAvailable();\n  };\n  /**\n   * {@link UndoRedo#clear}.\n   *\n   * @alias clearUndo\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n  instance.clearUndo = function () {\n    return instance.undoRedo.clear();\n  };\n}\n/**\n * @param {Core} instance The Handsontable instance.\n */\n\nfunction removeExposedUndoRedoMethods(instance) {\n  delete instance.undo;\n  delete instance.redo;\n  delete instance.isUndoAvailable;\n  delete instance.isRedoAvailable;\n  delete instance.clearUndo;\n}\nvar hook = Hooks.getSingleton();\nhook.add('afterUpdateSettings', function () {\n  var _this$getPlugin;\n  (_this$getPlugin = this.getPlugin('undoRedo')) === null || _this$getPlugin === void 0 ? void 0 : _this$getPlugin.init();\n});\nhook.register('beforeUndo');\nhook.register('afterUndo');\nhook.register('beforeRedo');\nhook.register('afterRedo');\nUndoRedo.PLUGIN_KEY = PLUGIN_KEY;\nexport default UndoRedo;","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","iter","Array","from","isArray","_arrayLikeToArray","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","minLen","n","toString","slice","name","test","len","arr2","_i","_arr","_n","_d","_s","_e","next","done","push","err","Hooks","arrayMap","arrayEach","rangeEach","inherit","deepClone","stopImmediatePropagation","isImmediatePropagationStopped","align","PLUGIN_KEY","UndoRedo","plugin","doneActions","undoneActions","ignoreNewActions","enabled","addHook","changes","source","_this","changesLen","hasDifferences","find","change","_change","oldValue","newValue","wrappedAction","clonedChanges","reduce","propToCol","selected","getSelected","ChangeAction","index","amount","CreateRowAction","logicRows","originalData","getSourceDataArray","rowIndex","physicalRowIndex","toPhysicalRow","removedData","RemoveRowAction","getSettings","fixedRowsBottom","fixedRowsTop","CreateColumnAction","logicColumns","columnIndex","countCols","headers","indexes","column","origRow","j","toPhysicalColumn","colHeaders","columnsMap","columnIndexMapper","getIndexesSequence","rowsMap","rowIndexMapper","RemoveColumnAction","fixedColumnsLeft","stateBefore","range","type","alignment","CellAlignmentAction","conditionsStack","FiltersAction","rows","finalIndex","RowMoveAction","cellRange","auto","MergeCellsAction","UnmergeCellsAction","init","isBlockedByDefault","doneActionsCopy","continueAction","runHooks","newAction","undoneActionsCopy","undo","isUndoAvailable","action","pop","actionClone","that","redo","isRedoAvailable","clear","isEnabled","enable","hot","exposeUndoRedoMethods","onBeforeKeyDown","onAfterChange","disable","removeExposedUndoRedoMethods","removeHook","destroy","Action","actionType","undoneCallback","data","emptyRowsAtTheEnd","countEmptyRows","emptyColsAtTheEnd","countEmptyCols","splice","addHookOnce","setDataAtCell","_i2","_len","_data$_i","row","minSpareRows","countRows","alter","parseInt","undoRedo","minSpareCols","selectCells","onFinishCallback","rowCount","redoneCallback","settings","populateFromArray","columnPositions","rowPositions","_this2","ascendingIndexes","sort","sortByIndexes","elem","indexOf","removedDataLength","sortedData","sortedHeaders","rowData","changedIndex","contiquesIndex","setSourceDataAtCell","insertIndexes","headerData","batchExecution","setIndexesSequence","render","_this3","forAll","col","setCellMeta","getCellMeta","filters","getPlugin","conditionCollection","importAllConditions","filter","_UndoRedo$Action","_super","_this4","topLeftCorner","getTopLeftCorner","bottomRightCorner","getBottomRightCorner","rangeData","getData","mergeCellsPlugin","unmergeRange","mergeRange","_UndoRedo$Action2","_super2","_this5","_this6","manualRowMove","copyOfRows","concat","rowsMovedUp","a","rowsMovedDown","allMovedRows","b","newPhysicalRow","toVisualRow","moveRow","deselectCell","selectRows","moveRows","pluginEnabled","event","editor","getActiveEditor","isOpened","altKey","ctrlKey","keyCode","metaKey","shiftKey","isCtrlDown","isRedoHotkey","clearUndo","hook","getSingleton","add","_this$getPlugin","register"],"sources":["/Users/priyadeliwala/Desktop/sales-dashboard/node_modules/handsontable/plugins/undoRedo/undoRedo.mjs"],"sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.object.set-prototype-of.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport Hooks from \"../../pluginHooks.mjs\";\nimport { arrayMap, arrayEach } from \"../../helpers/array.mjs\";\nimport { rangeEach } from \"../../helpers/number.mjs\";\nimport { inherit, deepClone } from \"../../helpers/object.mjs\";\nimport { stopImmediatePropagation, isImmediatePropagationStopped } from \"../../helpers/dom/event.mjs\";\nimport { align } from \"../contextMenu/utils.mjs\";\nexport var PLUGIN_KEY = 'undoRedo';\n/**\n * @description\n * Handsontable UndoRedo plugin allows to undo and redo certain actions done in the table.\n *\n * __Note__, that not all actions are currently undo-able. The UndoRedo plugin is enabled by default.\n * @example\n * ```js\n * undo: true\n * ```\n * @class UndoRedo\n * @plugin UndoRedo\n * @param {Core} instance The Handsontable instance.\n */\n\nfunction UndoRedo(instance) {\n  var plugin = this;\n  this.instance = instance;\n  this.doneActions = [];\n  this.undoneActions = [];\n  this.ignoreNewActions = false;\n  this.enabled = false;\n  instance.addHook('afterChange', function (changes, source) {\n    var _this = this;\n\n    var changesLen = changes && changes.length;\n\n    if (!changesLen) {\n      return;\n    }\n\n    var hasDifferences = changes.find(function (change) {\n      var _change = _slicedToArray(change, 4),\n          oldValue = _change[2],\n          newValue = _change[3];\n\n      return oldValue !== newValue;\n    });\n\n    if (!hasDifferences) {\n      return;\n    }\n\n    var wrappedAction = function wrappedAction() {\n      var clonedChanges = changes.reduce(function (arr, change) {\n        arr.push(_toConsumableArray(change));\n        return arr;\n      }, []);\n      arrayEach(clonedChanges, function (change) {\n        change[1] = instance.propToCol(change[1]);\n      });\n      var selected = changesLen > 1 ? _this.getSelected() : [[clonedChanges[0][0], clonedChanges[0][1]]];\n      return new UndoRedo.ChangeAction(clonedChanges, selected);\n    };\n\n    plugin.done(wrappedAction, source);\n  });\n  instance.addHook('afterCreateRow', function (index, amount, source) {\n    plugin.done(function () {\n      return new UndoRedo.CreateRowAction(index, amount);\n    }, source);\n  });\n  instance.addHook('beforeRemoveRow', function (index, amount, logicRows, source) {\n    var wrappedAction = function wrappedAction() {\n      var originalData = plugin.instance.getSourceDataArray();\n      var rowIndex = (originalData.length + index) % originalData.length;\n      var physicalRowIndex = instance.toPhysicalRow(rowIndex);\n      var removedData = deepClone(originalData.slice(physicalRowIndex, physicalRowIndex + amount));\n      return new UndoRedo.RemoveRowAction(rowIndex, removedData, instance.getSettings().fixedRowsBottom, instance.getSettings().fixedRowsTop);\n    };\n\n    plugin.done(wrappedAction, source);\n  });\n  instance.addHook('afterCreateCol', function (index, amount, source) {\n    plugin.done(function () {\n      return new UndoRedo.CreateColumnAction(index, amount);\n    }, source);\n  });\n  instance.addHook('beforeRemoveCol', function (index, amount, logicColumns, source) {\n    var wrappedAction = function wrappedAction() {\n      var originalData = plugin.instance.getSourceDataArray();\n      var columnIndex = (plugin.instance.countCols() + index) % plugin.instance.countCols();\n      var removedData = [];\n      var headers = [];\n      var indexes = [];\n      rangeEach(originalData.length - 1, function (i) {\n        var column = [];\n        var origRow = originalData[i];\n        rangeEach(columnIndex, columnIndex + (amount - 1), function (j) {\n          column.push(origRow[instance.toPhysicalColumn(j)]);\n        });\n        removedData.push(column);\n      });\n      rangeEach(amount - 1, function (i) {\n        indexes.push(instance.toPhysicalColumn(columnIndex + i));\n      });\n\n      if (Array.isArray(instance.getSettings().colHeaders)) {\n        rangeEach(amount - 1, function (i) {\n          headers.push(instance.getSettings().colHeaders[instance.toPhysicalColumn(columnIndex + i)] || null);\n        });\n      }\n\n      var columnsMap = instance.columnIndexMapper.getIndexesSequence();\n      var rowsMap = instance.rowIndexMapper.getIndexesSequence();\n      return new UndoRedo.RemoveColumnAction(columnIndex, indexes, removedData, headers, columnsMap, rowsMap, instance.getSettings().fixedColumnsLeft);\n    };\n\n    plugin.done(wrappedAction, source);\n  });\n  instance.addHook('beforeCellAlignment', function (stateBefore, range, type, alignment) {\n    plugin.done(function () {\n      return new UndoRedo.CellAlignmentAction(stateBefore, range, type, alignment);\n    });\n  });\n  instance.addHook('beforeFilter', function (conditionsStack) {\n    plugin.done(function () {\n      return new UndoRedo.FiltersAction(conditionsStack);\n    });\n  });\n  instance.addHook('beforeRowMove', function (rows, finalIndex) {\n    if (rows === false) {\n      return;\n    }\n\n    plugin.done(function () {\n      return new UndoRedo.RowMoveAction(rows, finalIndex);\n    });\n  });\n  instance.addHook('beforeMergeCells', function (cellRange, auto) {\n    if (auto) {\n      return;\n    }\n\n    plugin.done(function () {\n      return new UndoRedo.MergeCellsAction(instance, cellRange);\n    });\n  });\n  instance.addHook('afterUnmergeCells', function (cellRange, auto) {\n    if (auto) {\n      return;\n    }\n\n    plugin.done(function () {\n      return new UndoRedo.UnmergeCellsAction(instance, cellRange);\n    });\n  }); // TODO: Why this callback is needed? One test doesn't pass after calling method right after plugin creation (outside the callback).\n\n  instance.addHook('afterInit', function () {\n    plugin.init();\n  });\n}\n/**\n * Stash information about performed actions.\n *\n * @function done\n * @memberof UndoRedo#\n * @fires Hooks#beforeUndoStackChange\n * @fires Hooks#afterUndoStackChange\n * @fires Hooks#beforeRedoStackChange\n * @fires Hooks#afterRedoStackChange\n * @param {Function} wrappedAction The action descriptor wrapped in a closure.\n * @param {string} [source] Source of the action. It is defined just for more general actions (not related to plugins).\n */\n\n\nUndoRedo.prototype.done = function (wrappedAction, source) {\n  if (this.ignoreNewActions) {\n    return;\n  }\n\n  var isBlockedByDefault = source === 'UndoRedo.undo' || source === 'UndoRedo.redo' || source === 'auto';\n\n  if (isBlockedByDefault) {\n    return;\n  }\n\n  var doneActionsCopy = this.doneActions.slice();\n  var continueAction = this.instance.runHooks('beforeUndoStackChange', doneActionsCopy, source);\n\n  if (continueAction === false) {\n    return;\n  }\n\n  var newAction = wrappedAction();\n  var undoneActionsCopy = this.undoneActions.slice();\n  this.doneActions.push(newAction);\n  this.instance.runHooks('afterUndoStackChange', doneActionsCopy, this.doneActions.slice());\n  this.instance.runHooks('beforeRedoStackChange', undoneActionsCopy);\n  this.undoneActions.length = 0;\n  this.instance.runHooks('afterRedoStackChange', undoneActionsCopy, this.undoneActions.slice());\n};\n/**\n * Undo the last action performed to the table.\n *\n * @function undo\n * @memberof UndoRedo#\n * @fires Hooks#beforeUndoStackChange\n * @fires Hooks#afterUndoStackChange\n * @fires Hooks#beforeRedoStackChange\n * @fires Hooks#afterRedoStackChange\n * @fires Hooks#beforeUndo\n * @fires Hooks#afterUndo\n */\n\n\nUndoRedo.prototype.undo = function () {\n  if (this.isUndoAvailable()) {\n    var doneActionsCopy = this.doneActions.slice();\n    this.instance.runHooks('beforeUndoStackChange', doneActionsCopy);\n    var action = this.doneActions.pop();\n    this.instance.runHooks('afterUndoStackChange', doneActionsCopy, this.doneActions.slice());\n    var actionClone = deepClone(action);\n    var continueAction = this.instance.runHooks('beforeUndo', actionClone);\n\n    if (continueAction === false) {\n      return;\n    }\n\n    this.ignoreNewActions = true;\n    var that = this;\n    var undoneActionsCopy = this.undoneActions.slice();\n    this.instance.runHooks('beforeRedoStackChange', undoneActionsCopy);\n    action.undo(this.instance, function () {\n      that.ignoreNewActions = false;\n      that.undoneActions.push(action);\n    });\n    this.instance.runHooks('afterRedoStackChange', undoneActionsCopy, this.undoneActions.slice());\n    this.instance.runHooks('afterUndo', actionClone);\n  }\n};\n/**\n * Redo the previous action performed to the table (used to reverse an undo).\n *\n * @function redo\n * @memberof UndoRedo#\n * @fires Hooks#beforeUndoStackChange\n * @fires Hooks#afterUndoStackChange\n * @fires Hooks#beforeRedoStackChange\n * @fires Hooks#afterRedoStackChange\n * @fires Hooks#beforeRedo\n * @fires Hooks#afterRedo\n */\n\n\nUndoRedo.prototype.redo = function () {\n  if (this.isRedoAvailable()) {\n    var undoneActionsCopy = this.undoneActions.slice();\n    this.instance.runHooks('beforeRedoStackChange', undoneActionsCopy);\n    var action = this.undoneActions.pop();\n    this.instance.runHooks('afterRedoStackChange', undoneActionsCopy, this.undoneActions.slice());\n    var actionClone = deepClone(action);\n    var continueAction = this.instance.runHooks('beforeRedo', actionClone);\n\n    if (continueAction === false) {\n      return;\n    }\n\n    this.ignoreNewActions = true;\n    var that = this;\n    var doneActionsCopy = this.doneActions.slice();\n    this.instance.runHooks('beforeUndoStackChange', doneActionsCopy);\n    action.redo(this.instance, function () {\n      that.ignoreNewActions = false;\n      that.doneActions.push(action);\n    });\n    this.instance.runHooks('afterUndoStackChange', doneActionsCopy, this.doneActions.slice());\n    this.instance.runHooks('afterRedo', actionClone);\n  }\n};\n/**\n * Checks if undo action is available.\n *\n * @function isUndoAvailable\n * @memberof UndoRedo#\n * @returns {boolean} Return `true` if undo can be performed, `false` otherwise.\n */\n\n\nUndoRedo.prototype.isUndoAvailable = function () {\n  return this.doneActions.length > 0;\n};\n/**\n * Checks if redo action is available.\n *\n * @function isRedoAvailable\n * @memberof UndoRedo#\n * @returns {boolean} Return `true` if redo can be performed, `false` otherwise.\n */\n\n\nUndoRedo.prototype.isRedoAvailable = function () {\n  return this.undoneActions.length > 0;\n};\n/**\n * Clears undo history.\n *\n * @function clear\n * @memberof UndoRedo#\n */\n\n\nUndoRedo.prototype.clear = function () {\n  this.doneActions.length = 0;\n  this.undoneActions.length = 0;\n};\n/**\n * Checks if the plugin is enabled.\n *\n * @function isEnabled\n * @memberof UndoRedo#\n * @returns {boolean}\n */\n\n\nUndoRedo.prototype.isEnabled = function () {\n  return this.enabled;\n};\n/**\n * Enables the plugin.\n *\n * @function enable\n * @memberof UndoRedo#\n */\n\n\nUndoRedo.prototype.enable = function () {\n  if (this.isEnabled()) {\n    return;\n  }\n\n  var hot = this.instance;\n  this.enabled = true;\n  exposeUndoRedoMethods(hot);\n  hot.addHook('beforeKeyDown', onBeforeKeyDown);\n  hot.addHook('afterChange', onAfterChange);\n};\n/**\n * Disables the plugin.\n *\n * @function disable\n * @memberof UndoRedo#\n */\n\n\nUndoRedo.prototype.disable = function () {\n  if (!this.isEnabled()) {\n    return;\n  }\n\n  var hot = this.instance;\n  this.enabled = false;\n  removeExposedUndoRedoMethods(hot);\n  hot.removeHook('beforeKeyDown', onBeforeKeyDown);\n  hot.removeHook('afterChange', onAfterChange);\n};\n/**\n * Destroys the instance.\n *\n * @function destroy\n * @memberof UndoRedo#\n */\n\n\nUndoRedo.prototype.destroy = function () {\n  this.clear();\n  this.instance = null;\n  this.doneActions = null;\n  this.undoneActions = null;\n};\n\nUndoRedo.Action = function () {};\n\nUndoRedo.Action.prototype.undo = function () {};\n\nUndoRedo.Action.prototype.redo = function () {};\n/**\n * Change action.\n *\n * @private\n * @param {Array} changes 2D array containing information about each of the edited cells.\n * @param {number[]} selected The cell selection.\n */\n\n\nUndoRedo.ChangeAction = function (changes, selected) {\n  this.changes = changes;\n  this.selected = selected;\n  this.actionType = 'change';\n};\n\ninherit(UndoRedo.ChangeAction, UndoRedo.Action);\n\nUndoRedo.ChangeAction.prototype.undo = function (instance, undoneCallback) {\n  var data = deepClone(this.changes);\n  var emptyRowsAtTheEnd = instance.countEmptyRows(true);\n  var emptyColsAtTheEnd = instance.countEmptyCols(true);\n\n  for (var i = 0, len = data.length; i < len; i++) {\n    data[i].splice(3, 1);\n  }\n\n  instance.addHookOnce('afterChange', undoneCallback);\n  instance.setDataAtCell(data, null, null, 'UndoRedo.undo');\n\n  for (var _i2 = 0, _len = data.length; _i2 < _len; _i2++) {\n    var _data$_i = _slicedToArray(data[_i2], 2),\n        row = _data$_i[0],\n        column = _data$_i[1];\n\n    if (instance.getSettings().minSpareRows && row + 1 + instance.getSettings().minSpareRows === instance.countRows() && emptyRowsAtTheEnd === instance.getSettings().minSpareRows) {\n      instance.alter('remove_row', parseInt(row + 1, 10), instance.getSettings().minSpareRows);\n      instance.undoRedo.doneActions.pop();\n    }\n\n    if (instance.getSettings().minSpareCols && column + 1 + instance.getSettings().minSpareCols === instance.countCols() && emptyColsAtTheEnd === instance.getSettings().minSpareCols) {\n      instance.alter('remove_col', parseInt(column + 1, 10), instance.getSettings().minSpareCols);\n      instance.undoRedo.doneActions.pop();\n    }\n  }\n\n  instance.selectCells(this.selected, false, false);\n};\n\nUndoRedo.ChangeAction.prototype.redo = function (instance, onFinishCallback) {\n  var data = deepClone(this.changes);\n\n  for (var i = 0, len = data.length; i < len; i++) {\n    data[i].splice(2, 1);\n  }\n\n  instance.addHookOnce('afterChange', onFinishCallback);\n  instance.setDataAtCell(data, null, null, 'UndoRedo.redo');\n\n  if (this.selected) {\n    instance.selectCells(this.selected, false, false);\n  }\n};\n/**\n * Create row action.\n *\n * @private\n * @param {number} index The visual row index.\n * @param {number} amount The number of created rows.\n */\n\n\nUndoRedo.CreateRowAction = function (index, amount) {\n  this.index = index;\n  this.amount = amount;\n  this.actionType = 'insert_row';\n};\n\ninherit(UndoRedo.CreateRowAction, UndoRedo.Action);\n\nUndoRedo.CreateRowAction.prototype.undo = function (instance, undoneCallback) {\n  var rowCount = instance.countRows();\n  var minSpareRows = instance.getSettings().minSpareRows;\n\n  if (this.index >= rowCount && this.index - minSpareRows < rowCount) {\n    this.index -= minSpareRows; // work around the situation where the needed row was removed due to an 'undo' of a made change\n  }\n\n  instance.addHookOnce('afterRemoveRow', undoneCallback);\n  instance.alter('remove_row', this.index, this.amount, 'UndoRedo.undo');\n};\n\nUndoRedo.CreateRowAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterCreateRow', redoneCallback);\n  instance.alter('insert_row', this.index, this.amount, 'UndoRedo.redo');\n};\n/**\n * Remove row action.\n *\n * @private\n * @param {number} index The visual row index.\n * @param {Array} data The removed data.\n * @param {number} fixedRowsBottom Number of fixed rows on the bottom. Remove row action change it sometimes.\n * @param {number} fixedRowsTop Number of fixed rows on the top. Remove row action change it sometimes.\n */\n\n\nUndoRedo.RemoveRowAction = function (index, data, fixedRowsBottom, fixedRowsTop) {\n  this.index = index;\n  this.data = data;\n  this.actionType = 'remove_row';\n  this.fixedRowsBottom = fixedRowsBottom;\n  this.fixedRowsTop = fixedRowsTop;\n};\n\ninherit(UndoRedo.RemoveRowAction, UndoRedo.Action);\n\nUndoRedo.RemoveRowAction.prototype.undo = function (instance, undoneCallback) {\n  var settings = instance.getSettings(); // Changing by the reference as `updateSettings` doesn't work the best.\n\n  settings.fixedRowsBottom = this.fixedRowsBottom;\n  settings.fixedRowsTop = this.fixedRowsTop;\n  instance.alter('insert_row', this.index, this.data.length, 'UndoRedo.undo');\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.populateFromArray(this.index, 0, this.data, void 0, void 0, 'UndoRedo.undo');\n};\n\nUndoRedo.RemoveRowAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterRemoveRow', redoneCallback);\n  instance.alter('remove_row', this.index, this.data.length, 'UndoRedo.redo');\n};\n/**\n * Create column action.\n *\n * @private\n * @param {number} index The visual column index.\n * @param {number} amount The number of created columns.\n */\n\n\nUndoRedo.CreateColumnAction = function (index, amount) {\n  this.index = index;\n  this.amount = amount;\n  this.actionType = 'insert_col';\n};\n\ninherit(UndoRedo.CreateColumnAction, UndoRedo.Action);\n\nUndoRedo.CreateColumnAction.prototype.undo = function (instance, undoneCallback) {\n  instance.addHookOnce('afterRemoveCol', undoneCallback);\n  instance.alter('remove_col', this.index, this.amount, 'UndoRedo.undo');\n};\n\nUndoRedo.CreateColumnAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterCreateCol', redoneCallback);\n  instance.alter('insert_col', this.index, this.amount, 'UndoRedo.redo');\n};\n/**\n * Remove column action.\n *\n * @private\n * @param {number} index The visual column index.\n * @param {number[]} indexes The visual column indexes.\n * @param {Array} data The removed data.\n * @param {Array} headers The header values.\n * @param {number[]} columnPositions The column position.\n * @param {number[]} rowPositions The row position.\n * @param {number} fixedColumnsLeft Number of fixed columns on the left. Remove column action change it sometimes.\n */\n\n\nUndoRedo.RemoveColumnAction = function (index, indexes, data, headers, columnPositions, rowPositions, fixedColumnsLeft) {\n  this.index = index;\n  this.indexes = indexes;\n  this.data = data;\n  this.amount = this.data[0].length;\n  this.headers = headers;\n  this.columnPositions = columnPositions.slice(0);\n  this.rowPositions = rowPositions.slice(0);\n  this.actionType = 'remove_col';\n  this.fixedColumnsLeft = fixedColumnsLeft;\n};\n\ninherit(UndoRedo.RemoveColumnAction, UndoRedo.Action);\n\nUndoRedo.RemoveColumnAction.prototype.undo = function (instance, undoneCallback) {\n  var _this2 = this;\n\n  var settings = instance.getSettings(); // Changing by the reference as `updateSettings` doesn't work the best.\n\n  settings.fixedColumnsLeft = this.fixedColumnsLeft;\n  var ascendingIndexes = this.indexes.slice(0).sort();\n\n  var sortByIndexes = function sortByIndexes(elem, j, arr) {\n    return arr[_this2.indexes.indexOf(ascendingIndexes[j])];\n  };\n\n  var removedDataLength = this.data.length;\n  var sortedData = [];\n\n  for (var rowIndex = 0; rowIndex < removedDataLength; rowIndex++) {\n    sortedData.push(arrayMap(this.data[rowIndex], sortByIndexes));\n  }\n\n  var sortedHeaders = arrayMap(this.headers, sortByIndexes);\n  var changes = [];\n  instance.alter('insert_col', this.indexes[0], this.indexes.length, 'UndoRedo.undo');\n  arrayEach(instance.getSourceDataArray(), function (rowData, rowIndex) {\n    arrayEach(ascendingIndexes, function (changedIndex, contiquesIndex) {\n      rowData[changedIndex] = sortedData[rowIndex][contiquesIndex];\n      changes.push([rowIndex, changedIndex, rowData[changedIndex]]);\n    });\n  });\n  instance.setSourceDataAtCell(changes, void 0, void 0, 'UndoRedo.undo');\n  instance.columnIndexMapper.insertIndexes(ascendingIndexes[0], ascendingIndexes.length);\n\n  if (typeof this.headers !== 'undefined') {\n    arrayEach(sortedHeaders, function (headerData, columnIndex) {\n      instance.getSettings().colHeaders[ascendingIndexes[columnIndex]] = headerData;\n    });\n  }\n\n  instance.batchExecution(function () {\n    // Restore row sequence in a case when all columns are removed. the original\n    // row sequence is lost in that case.\n    instance.rowIndexMapper.setIndexesSequence(_this2.rowPositions);\n    instance.columnIndexMapper.setIndexesSequence(_this2.columnPositions);\n  }, true);\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.render();\n};\n\nUndoRedo.RemoveColumnAction.prototype.redo = function (instance, redoneCallback) {\n  instance.addHookOnce('afterRemoveCol', redoneCallback);\n  instance.alter('remove_col', this.index, this.amount, 'UndoRedo.redo');\n};\n/**\n * Cell alignment action.\n *\n * @private\n * @param {Array} stateBefore The previous state.\n * @param {object} range The cell range.\n * @param {string} type The type of the alignment (\"top\", \"left\", \"bottom\" or \"right\").\n * @param {string} alignment The alignment CSS class.\n */\n\n\nUndoRedo.CellAlignmentAction = function (stateBefore, range, type, alignment) {\n  this.stateBefore = stateBefore;\n  this.range = range;\n  this.type = type;\n  this.alignment = alignment;\n};\n\nUndoRedo.CellAlignmentAction.prototype.undo = function (instance, undoneCallback) {\n  var _this3 = this;\n\n  arrayEach(this.range, function (range) {\n    range.forAll(function (row, col) {\n      // Alignment classes should only collected within cell ranges. We skip header coordinates.\n      if (row >= 0 && col >= 0) {\n        instance.setCellMeta(row, col, 'className', _this3.stateBefore[row][col] || ' htLeft');\n      }\n    });\n  });\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.render();\n};\n\nUndoRedo.CellAlignmentAction.prototype.redo = function (instance, undoneCallback) {\n  align(this.range, this.type, this.alignment, function (row, col) {\n    return instance.getCellMeta(row, col);\n  }, function (row, col, key, value) {\n    return instance.setCellMeta(row, col, key, value);\n  });\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  instance.render();\n};\n/**\n * Filters action.\n *\n * @private\n * @param {Array} conditionsStack An array of the filter condition.\n */\n\n\nUndoRedo.FiltersAction = function (conditionsStack) {\n  this.conditionsStack = conditionsStack;\n  this.actionType = 'filter';\n};\n\ninherit(UndoRedo.FiltersAction, UndoRedo.Action);\n\nUndoRedo.FiltersAction.prototype.undo = function (instance, undoneCallback) {\n  var filters = instance.getPlugin('filters');\n  instance.addHookOnce('afterViewRender', undoneCallback);\n  filters.conditionCollection.importAllConditions(this.conditionsStack.slice(0, this.conditionsStack.length - 1));\n  filters.filter();\n};\n\nUndoRedo.FiltersAction.prototype.redo = function (instance, redoneCallback) {\n  var filters = instance.getPlugin('filters');\n  instance.addHookOnce('afterViewRender', redoneCallback);\n  filters.conditionCollection.importAllConditions(this.conditionsStack);\n  filters.filter();\n};\n/**\n * Merge Cells action.\n *\n * @util\n */\n\n\nvar MergeCellsAction = /*#__PURE__*/function (_UndoRedo$Action) {\n  _inherits(MergeCellsAction, _UndoRedo$Action);\n\n  var _super = _createSuper(MergeCellsAction);\n\n  function MergeCellsAction(instance, cellRange) {\n    var _this4;\n\n    _classCallCheck(this, MergeCellsAction);\n\n    _this4 = _super.call(this);\n    _this4.cellRange = cellRange;\n\n    var topLeftCorner = _this4.cellRange.getTopLeftCorner();\n\n    var bottomRightCorner = _this4.cellRange.getBottomRightCorner();\n\n    _this4.rangeData = instance.getData(topLeftCorner.row, topLeftCorner.col, bottomRightCorner.row, bottomRightCorner.col);\n    return _this4;\n  }\n\n  _createClass(MergeCellsAction, [{\n    key: \"undo\",\n    value: function undo(instance, undoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', undoneCallback);\n      mergeCellsPlugin.unmergeRange(this.cellRange, true);\n      var topLeftCorner = this.cellRange.getTopLeftCorner();\n      instance.populateFromArray(topLeftCorner.row, topLeftCorner.col, this.rangeData, void 0, void 0, 'MergeCells');\n    }\n  }, {\n    key: \"redo\",\n    value: function redo(instance, redoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', redoneCallback);\n      mergeCellsPlugin.mergeRange(this.cellRange);\n    }\n  }]);\n\n  return MergeCellsAction;\n}(UndoRedo.Action);\n\nUndoRedo.MergeCellsAction = MergeCellsAction;\n/**\n * Unmerge Cells action.\n *\n * @util\n */\n\nvar UnmergeCellsAction = /*#__PURE__*/function (_UndoRedo$Action2) {\n  _inherits(UnmergeCellsAction, _UndoRedo$Action2);\n\n  var _super2 = _createSuper(UnmergeCellsAction);\n\n  function UnmergeCellsAction(instance, cellRange) {\n    var _this5;\n\n    _classCallCheck(this, UnmergeCellsAction);\n\n    _this5 = _super2.call(this);\n    _this5.cellRange = cellRange;\n    return _this5;\n  }\n\n  _createClass(UnmergeCellsAction, [{\n    key: \"undo\",\n    value: function undo(instance, undoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', undoneCallback);\n      mergeCellsPlugin.mergeRange(this.cellRange, true);\n    }\n  }, {\n    key: \"redo\",\n    value: function redo(instance, redoneCallback) {\n      var mergeCellsPlugin = instance.getPlugin('mergeCells');\n      instance.addHookOnce('afterViewRender', redoneCallback);\n      mergeCellsPlugin.unmergeRange(this.cellRange, true);\n      instance.render();\n    }\n  }]);\n\n  return UnmergeCellsAction;\n}(UndoRedo.Action);\n\nUndoRedo.UnmergeCellsAction = UnmergeCellsAction;\n/**\n * ManualRowMove action.\n *\n * @TODO removeRow undo should works on logical index\n * @private\n * @param {number[]} rows An array with moved rows.\n * @param {number} finalIndex The destination index.\n */\n\nUndoRedo.RowMoveAction = function (rows, finalIndex) {\n  this.rows = rows.slice();\n  this.finalIndex = finalIndex;\n  this.actionType = 'row_move';\n};\n\ninherit(UndoRedo.RowMoveAction, UndoRedo.Action);\n\nUndoRedo.RowMoveAction.prototype.undo = function (instance, undoneCallback) {\n  var _this6 = this;\n\n  var manualRowMove = instance.getPlugin('manualRowMove');\n  var copyOfRows = [].concat(this.rows);\n  var rowsMovedUp = copyOfRows.filter(function (a) {\n    return a > _this6.finalIndex;\n  });\n  var rowsMovedDown = copyOfRows.filter(function (a) {\n    return a <= _this6.finalIndex;\n  });\n  var allMovedRows = rowsMovedUp.sort(function (a, b) {\n    return b - a;\n  }).concat(rowsMovedDown.sort(function (a, b) {\n    return a - b;\n  }));\n  instance.addHookOnce('afterViewRender', undoneCallback); // Moving rows from those with higher indexes to those with lower indexes when action was performed from bottom to top\n  // Moving rows from those with lower indexes to those with higher indexes when action was performed from top to bottom\n\n  for (var i = 0; i < allMovedRows.length; i += 1) {\n    var newPhysicalRow = instance.toVisualRow(allMovedRows[i]);\n    manualRowMove.moveRow(newPhysicalRow, allMovedRows[i]);\n  }\n\n  instance.render();\n  instance.deselectCell();\n  instance.selectRows(this.rows[0], this.rows[0] + this.rows.length - 1);\n};\n\nUndoRedo.RowMoveAction.prototype.redo = function (instance, redoneCallback) {\n  var manualRowMove = instance.getPlugin('manualRowMove');\n  instance.addHookOnce('afterViewRender', redoneCallback);\n  manualRowMove.moveRows(this.rows.slice(), this.finalIndex);\n  instance.render();\n  instance.deselectCell();\n  instance.selectRows(this.finalIndex, this.finalIndex + this.rows.length - 1);\n};\n/**\n * Enabling and disabling plugin and attaching its to an instance.\n *\n * @private\n */\n\n\nUndoRedo.prototype.init = function () {\n  var settings = this.instance.getSettings().undo;\n  var pluginEnabled = typeof settings === 'undefined' || settings;\n\n  if (!this.instance.undoRedo) {\n    this.instance.undoRedo = this;\n  }\n\n  if (pluginEnabled) {\n    this.instance.undoRedo.enable();\n  } else {\n    this.instance.undoRedo.disable();\n  }\n};\n/**\n * @param {Event} event The keyboard event object.\n */\n\n\nfunction onBeforeKeyDown(event) {\n  if (isImmediatePropagationStopped(event)) {\n    return;\n  }\n\n  var instance = this;\n  var editor = instance.getActiveEditor();\n\n  if (editor && editor.isOpened()) {\n    return;\n  }\n\n  var altKey = event.altKey,\n      ctrlKey = event.ctrlKey,\n      keyCode = event.keyCode,\n      metaKey = event.metaKey,\n      shiftKey = event.shiftKey;\n  var isCtrlDown = (ctrlKey || metaKey) && !altKey;\n\n  if (!isCtrlDown) {\n    return;\n  }\n\n  var isRedoHotkey = keyCode === 89 || shiftKey && keyCode === 90;\n\n  if (isRedoHotkey) {\n    // CTRL + Y or CTRL + SHIFT + Z\n    instance.undoRedo.redo();\n    stopImmediatePropagation(event);\n  } else if (keyCode === 90) {\n    // CTRL + Z\n    instance.undoRedo.undo();\n    stopImmediatePropagation(event);\n  }\n}\n/**\n * @param {Array} changes 2D array containing information about each of the edited cells.\n * @param {string} source String that identifies source of hook call.\n * @returns {boolean}\n */\n\n\nfunction onAfterChange(changes, source) {\n  var instance = this;\n\n  if (source === 'loadData') {\n    return instance.undoRedo.clear();\n  }\n}\n/**\n * @param {Core} instance The Handsontable instance.\n */\n\n\nfunction exposeUndoRedoMethods(instance) {\n  /**\n   * {@link UndoRedo#undo}.\n   *\n   * @alias undo\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n  instance.undo = function () {\n    return instance.undoRedo.undo();\n  };\n  /**\n   * {@link UndoRedo#redo}.\n   *\n   * @alias redo\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n\n  instance.redo = function () {\n    return instance.undoRedo.redo();\n  };\n  /**\n   * {@link UndoRedo#isUndoAvailable}.\n   *\n   * @alias isUndoAvailable\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n\n  instance.isUndoAvailable = function () {\n    return instance.undoRedo.isUndoAvailable();\n  };\n  /**\n   * {@link UndoRedo#isRedoAvailable}.\n   *\n   * @alias isRedoAvailable\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n\n  instance.isRedoAvailable = function () {\n    return instance.undoRedo.isRedoAvailable();\n  };\n  /**\n   * {@link UndoRedo#clear}.\n   *\n   * @alias clearUndo\n   * @memberof! Core#\n   * @returns {boolean}\n   */\n\n\n  instance.clearUndo = function () {\n    return instance.undoRedo.clear();\n  };\n}\n/**\n * @param {Core} instance The Handsontable instance.\n */\n\n\nfunction removeExposedUndoRedoMethods(instance) {\n  delete instance.undo;\n  delete instance.redo;\n  delete instance.isUndoAvailable;\n  delete instance.isRedoAvailable;\n  delete instance.clearUndo;\n}\n\nvar hook = Hooks.getSingleton();\nhook.add('afterUpdateSettings', function () {\n  var _this$getPlugin;\n\n  (_this$getPlugin = this.getPlugin('undoRedo')) === null || _this$getPlugin === void 0 ? void 0 : _this$getPlugin.init();\n});\nhook.register('beforeUndo');\nhook.register('afterUndo');\nhook.register('beforeRedo');\nhook.register('afterRedo');\nUndoRedo.PLUGIN_KEY = PLUGIN_KEY;\nexport default UndoRedo;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}